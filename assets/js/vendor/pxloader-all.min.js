/*!  | http://thinkpixellab.com/PxLoader */
!function(t,n){"function"==typeof define&&define.amd?define([],function(){return t.PxLoader=n()}):"object"==typeof module&&module.exports?module.exports=n():t.PxLoader=n()}(this,function(){function t(t){t=t||{},this.settings=t,null==t.statusInterval&&(t.statusInterval=5e3),null==t.loggingDelay&&(t.loggingDelay=2e4),null==t.noProgressTimeout&&(t.noProgressTimeout=1/0)
var e,o=[],i=[],r=[],a=Date.now(),u={QUEUED:0,WAITING:1,LOADED:2,ERROR:3,TIMEOUT:4},s=function(t){return null==t?[]:Array.isArray(t)?t:[t]}
this.add=function(t){t.tags=new n(t.tags),null==t.priority&&(t.priority=1/0),o.push({resource:t,status:u.QUEUED})},this.addProgressListener=function(t,e){r.push({callback:t,tags:new n(e)})},this.addCompletionListener=function(t,e){i.push({tags:new n(e),callback:function(n){n.completedCount===n.totalCount&&t(n)}})}
var d=function(t){t=s(t)
var n=function(n){for(var e=n.resource,o=1/0,i=0;i<e.tags.length;i++)for(var r=0;r<Math.min(t.length,o)&&!(e.tags.all[i]===t[r]&&o>r&&(o=r,0===o))&&0!==o;r++);return o}
return function(t,e){var o=n(t),i=n(e)
return i>o?-1:o>i?1:t.priority<e.priority?-1:t.priority>e.priority?1:0}}
this.start=function(t){e=Date.now()
var n=d(t)
o.sort(n)
for(var i=0,r=o.length;r>i;i++){var a=o[i]
a.status=u.WAITING,a.resource.start(this)}setTimeout(c,100)}
var c=function(){for(var n=!1,e=Date.now()-a,i=e>=t.noProgressTimeout,r=e>=t.loggingDelay,s=0,d=o.length;d>s;s++){var f=o[s]
f.status===u.WAITING&&(f.resource.checkStatus&&f.resource.checkStatus(),f.status===u.WAITING&&(i?f.resource.onTimeout():n=!0))}r&&n&&l(),n&&setTimeout(c,t.statusInterval)}
this.isBusy=function(){for(var t=0,n=o.length;n>t;t++)if(o[t].status===u.QUEUED||o[t].status===u.WAITING)return!0
return!1}
var f=function(t,n){var e,s,d,c,f,l=null
for(e=0,s=o.length;s>e;e++)if(o[e].resource===t){l=o[e]
break}if(null!=l&&l.status===u.WAITING)for(l.status=n,a=Date.now(),d=r.concat(i),e=0,s=d.length;s>e;e++)c=d[e],f=0===c.tags.length?!0:t.tags.intersects(c.tags),f&&h(l,c)}
this.onLoad=function(t){f(t,u.LOADED)},this.onError=function(t){f(t,u.ERROR)},this.onTimeout=function(t){f(t,u.TIMEOUT)}
var h=function(t,n){var e,i,r,a,s=0,d=0
for(e=0,i=o.length;i>e;e++)r=o[e],a=!1,a=0===n.tags.length?!0:r.resource.tags.intersects(n.tags),a&&(d++,(r.status===u.LOADED||r.status===u.ERROR||r.status===u.TIMEOUT)&&s++)
n.callback({resource:t.resource,loaded:t.status===u.LOADED,error:t.status===u.ERROR,timeout:t.status===u.TIMEOUT,completedCount:s,totalCount:d})},l=this.log=function(t){if(window.console){var n=Math.round((Date.now()-e)/1e3)
window.console.log("PxLoader elapsed: "+n+" sec")
for(var i=0,r=o.length;r>i;i++){var a=o[i]
if(t||a.status===u.WAITING){var s="PxLoader: #"+i+" "+a.resource.getName()
switch(a.status){case u.QUEUED:s+=" (Not Started)"
break
case u.WAITING:s+=" (Waiting)"
break
case u.LOADED:s+=" (Loaded)"
break
case u.ERROR:s+=" (Error)"
break
case u.TIMEOUT:s+=" (Timeout)"}a.resource.tags.length>0&&(s+=" Tags: ["+a.resource.tags.all.join(",")+"]"),window.console.log(s)}}}}}function n(t){if(this.all=[],this.first=null,this.length=0,this.lookup={},t){if(Array.isArray(t))this.all=t.slice(0)
else if("object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&this.all.push(n)
else this.all.push(t)
this.length=this.all.length,this.length>0&&(this.first=this.all[0])
for(var e=0;e<this.length;e++)this.lookup[this.all[e]]=!0}}return n.prototype.intersects=function(t){if(0===this.length||0===t.length)return!1
if(1===this.length&&1===t.length)return this.first===t.first
if(t.length<this.length)return t.intersects(this)
for(var n in this.lookup)if(t.lookup[n])return!0
return!1},t}),function(t,n){"function"==typeof define&&define.amd?define(["pxloader"],function(e){return t.PxLoaderImage=n(e)}):"object"==typeof module&&module.exports?module.exports=n(require("pxloader")):t.PxLoaderImage=n(t.PxLoader)}(this,function(t){function n(t,n,e,o){o=o||{}
var i,r=this,a=null
i=this.img=new Image,o.origin&&(i.crossOrigin=o.origin),this.tags=n,this.priority=e
var u=function(){"complete"===r.img.readyState&&s()},s=function(){a.onLoad(r),f()},d=function(){a.onError(r),f()},c=function(){a.onTimeout(r),f()},f=function(){r.unbind("load",s),r.unbind("readystatechange",u),r.unbind("error",d)}
this.start=function(n){a=n,r.bind("load",s),r.bind("readystatechange",u),r.bind("error",d),r.img.src=t},this.checkStatus=function(){u()},this.onTimeout=function(){r.img.complete?s():c()},this.getName=function(){return t},this.bind=function(t,n){r.img.addEventListener(t,n,!1)},this.unbind=function(t,n){r.img.removeEventListener(t,n,!1)}}return t.prototype.addImage=function(t,e,o,i){var r=new n(t,e,o,i)
return this.add(r),r.img},n}),function(t,n){"function"==typeof define&&define.amd?define(["pxloader"],function(e){return t.PxLoaderSound=n(e)}):"object"==typeof module&&module.exports?module.exports=n(require("pxloader")):t.PxLoaderSound=n(t.PxLoader)}(this,function(t){function n(t,n,e,o,i){var r=this,a=null,u=navigator.userAgent.match(/(ipad|iphone|ipod)/i),s=navigator.userAgent.match(/android/i)
this.useGlobalHTML5Audio=u||s,this.tags=e,this.priority=o,this.sound=soundManager.createSound({id:t,url:n,autoLoad:!1,onload:function(){a.onLoad(r)},onsuspend:function(){a.onTimeout(r)},whileloading:function(){var t=this.bytesLoaded,n=this.bytesTotal
t>0&&t===n&&a.onLoad(r)}}),this.start=function(t){a=t,this.useGlobalHTML5Audio?a.onTimeout(r):this.sound.load()},this.checkStatus=function(){switch(r.sound.readyState){case 0:break
case 1:break
case 2:a.onError(r)
break
case 3:a.onLoad(r)}},this.onTimeout=function(){a.onTimeout(r)},this.getName=function(){return n}}return t.prototype.addSound=function(t,e,o,i,r){var a=new n(t,e,o,i,r)
return this.add(a),a.sound},n}),function(t,n){"function"==typeof define&&define.amd?define(["pxloader"],function(e){return t.PxLoaderVideo=n(e)}):"object"==typeof module&&module.exports?module.exports=n(require("pxloader")):t.PxLoaderVideo=n(t.PxLoader)}(this,function(t){function n(t,n,e,o){o=o||{}
var i,r=this,a=null
this.readyEventName="canplaythrough",i=this.video=document.createElement("video"),o.origin&&(i.crossOrigin=o.origin),i.preload="auto",this.tags=n,this.priority=e
var u=function(){4===r.video.readyState&&s()},s=function(){a.onLoad(r),f()},d=function(){a.onError(r),f()},c=function(){a.onTimeout(r),f()},f=function(){r.unbind("load",s),r.unbind(r.readyEventName,u),r.unbind("error",d),r.video.src=""}
this.start=function(n){a=n,r.bind("load",s),r.bind(r.readyEventName,u),r.bind("error",d),r.bind("suspend",s),r.video.src=t,r.video.load()},this.checkStatus=function(){u()},this.onTimeout=function(){4!==r.video.readyState?s():c()},this.getName=function(){return t},this.bind=function(t,n){r.video.addEventListener(t,n,!1)},this.unbind=function(t,n){r.video.removeEventListener(t,n,!1)}}return t.prototype.addVideo=function(t,e,o,i){var r=new n(t,e,o,i)
return this.add(r),r.video},n}),function(t,n){"function"==typeof define&&define.amd?define(["pxloader"],function(e){return t.PxLoaderData=n(e)}):"object"==typeof module&&module.exports?module.exports=n(require("pxloader")):t.PxLoaderData=n(t.PxLoader)}(this,function(t){function n(t,n,e,o){o=o||{}
var i=this,r=null
this.tags=n,this.priority=e,this.xhr=new XMLHttpRequest
var a=function(){4===i.xhr.readyState&&(200===i.xhr.status?u():s())},u=function(){r.onLoad(i),c()},s=function(){r.onError(i),c()},d=function(){r.onTimeout(i),c()},c=function(){i.unbind("readystatechange",a),i.unbind("error",s)}
this.start=function(n){r=n,i.bind("readystatechange",a),i.bind("error",s),i.xhr.open("GET",t,!0),i.xhr.send(null),i.xhr.responseType=o.responseType?o.responseType:""},this.checkStatus=function(){a()},this.onTimeout=function(){4===i.xhr.readyState?200===i.xhr.status?u():s():d()},this.getName=function(){return t},this.bind=function(t,n){i.xhr.addEventListener(t,n,!1)},this.unbind=function(t,n){i.xhr.removeEventListener(t,n,!1)}}return t.prototype.addData=function(t,e,o,i){var r=new n(t,e,o,i)
return this.add(r),r.xhr},n}),function(t,n){"function"==typeof define&&define.amd?define(["pxloader"],function(e){return t.PxLoaderAudio=n(e)}):"object"==typeof module&&module.exports?module.exports=n(require("pxloader")):t.PxLoaderAudio=n(t.PxLoader)}(this,function(t){function n(t,n,e,o){o=o||{}
var i,r=this,a=null
this.readyEventName="canplaythrough",i=this.audio=document.createElement("audio"),o.origin&&(i.crossOrigin=o.origin),i.preload="auto",this.tags=n,this.priority=e
var u=function(){4===r.audio.readyState&&s()},s=function(){a.onLoad(r),f()},d=function(){a.onError(r),f()},c=function(){a.onTimeout(r),f()},f=function(){r.unbind("load",s),r.unbind(r.readyEventName,u),r.unbind("error",d),r.audio.src=""}
this.start=function(n){a=n,r.bind("load",s),r.bind(r.readyEventName,u),r.bind("error",d),r.bind("suspend",s),r.audio.src=t,r.audio.load()},this.checkStatus=function(){u()},this.onTimeout=function(){4!==r.audio.readyState?s():c()},this.getName=function(){return t},this.bind=function(t,n){r.audio.addEventListener(t,n,!1)},this.unbind=function(t,n){r.audio.removeEventListener(t,n,!1)}}return t.prototype.addAudio=function(t,e,o,i){var r=new n(t,e,o,i)
return this.add(r),r.audio},n})
